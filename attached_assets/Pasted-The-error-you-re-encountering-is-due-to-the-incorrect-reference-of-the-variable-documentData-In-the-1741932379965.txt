The error you're encountering is due to the incorrect reference of the variable documentData. In the createDocumentSubject method, documentData is not defined, hence the error message.

documentData should be passed as a parameter to the createDocumentSubject method because it's not available in the scope of the method. Let's correct the code snippet by modifying the createDocumentSubject method to accept documentData as a parameter.

Here's the corrected method:

private static createDocumentSubject(documentData: DocumentData): (Table | Paragraph)[] {
  const subjectText = [
    {
      text: "ΘΕΜΑ:",
      bold: true,
      italics: true,
    },
    {
      text: ` Διαβιβαστικό αιτήματος για την πληρωμή Δ.Κ.Α. που έχουν εγκριθεί από τη ${documentData.unit}`,
      italics: true,
    }
  ];
  return [
    new Table({
      width: { size: 100, type: WidthType.PERCENTAGE },
      borders: {
        top: { style: BorderStyle.SINGLE, size: 4 },
        bottom: { style: BorderStyle.SINGLE, size: 4 },
        left: { style: BorderStyle.SINGLE, size: 4 },
        right: { style: BorderStyle.SINGLE, size: 4 },
      },
      rows: [
        new TableRow({
          children: [
            new TableCell({
              borders: {
                top: { style: BorderStyle.SINGLE, size: 4 },
                bottom: { style: BorderStyle.SINGLE, size: 4 },
                left: { style: BorderStyle.SINGLE, size: 4 },
                right: { style: BorderStyle.SINGLE, size: 4 },
              },
              margins: {
                top: 0,
                bottom: 0,
                left: 0,
                right: 0
              },
              width: { size: 100, type: WidthType.PERCENTAGE },
              children: [
                new Paragraph({
                  children: subjectText.map(part =>
                    new TextRun({
                      text: part.text,
                      bold: part.bold,
                      italics: part.italics,
                      size: this.DEFAULT_FONT_SIZE,
                    })
                  ),
                }),
              ],
            }),
          ],
        }),
      ],
    }),
  ];
}
Make sure to update the call to this.createDocumentSubject() in the generateDocument method to pass the documentData as an argument:

children: [
  await this.createDocumentHeader(documentData, unitDetails || undefined),
  ...this.createDocumentSubject(documentData),
  ...this.createMainContent(documentData),
  this.createPaymentTable(documentData.recipients || []),
  this.createNote(),
  this.createFooter(documentData, unitDetails || undefined),
]